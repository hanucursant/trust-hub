<div class="feed-container">
  <!-- Tab Navigation -->
  <div class="tabs-nav">
    <button 
      *ngFor="let tab of tabs" 
      class="tab-button"
      [class.active]="tab === selectedTab"
      (click)="selectTab(tab)"
    >
      {{ tab }}
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    Loading jobs...
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    {{ error }}
  </div>

  <!-- Jobs List -->
  <div class="jobs-list" *ngIf="!loading && !error">
    <div *ngIf="jobs.length === 0" class="empty-state">
      <p>No jobs found for this filter.</p>
    </div>

    <article *ngFor="let job of jobs" class="job-card">
      <!-- Job Header -->
      <div class="job-header">
        <div class="job-title-section">
          <h3 class="job-title">{{ job.title }}</h3>
          <div class="job-meta">
            <span class="job-id">#{{ job.id }}</span>
            <span class="separator">¬∑</span>
            <span class="job-date">{{ formatDate(job.created_at) }}</span>
          </div>
        </div>
        <div class="job-badges">
          <span class="service-badge" [ngClass]="getServiceTypeClass(job.service_type)">
            {{ getServiceTypeLabel(job.service_type) }}
          </span>
          <span class="status-badge" [ngClass]="getStatusClass(job.status)">
            {{ getStatusLabel(job.status) }}
          </span>
        </div>
      </div>

      <!-- Job Description -->
      <div class="job-description">
        <p>{{ job.description }}</p>
      </div>

      <!-- Job Details -->
      <div class="job-details">
        <div class="detail-item">
          <span class="detail-label">Budget:</span>
          <span class="detail-value budget">{{ formatCurrency(job.budget) }}</span>
        </div>
        <div class="detail-item" *ngIf="job.deadline">
          <span class="detail-label">Deadline:</span>
          <span class="detail-value">{{ formatDate(job.deadline) }}</span>
        </div>
        <div class="detail-item" *ngIf="job.deliverables">
          <span class="detail-label">Deliverables:</span>
          <span class="detail-value">{{ job.deliverables }}</span>
        </div>
      </div>

      <!-- Service Type Info -->
      <div class="service-info">
        <span class="info-icon">‚ÑπÔ∏è</span>
        <span class="info-text">{{ getServiceTypeDescription(job.service_type) }}</span>
      </div>

      <!-- Escrow Status -->
      <div class="escrow-status" *ngIf="job.escrow">
        <div class="escrow-badge">
          <span class="escrow-icon">üîí</span>
          <span class="escrow-text">
            Escrow: {{ formatCurrency(job.escrow.total_amount) }} 
            (Fee: {{ formatCurrency(job.escrow.platform_fee) }})
          </span>
        </div>
        <span class="escrow-status-badge" [ngClass]="'escrow-' + job.escrow.status">
          {{ job.escrow.status }}
        </span>
      </div>

      <!-- Milestones -->
      <div class="milestones" *ngIf="job.milestones && job.milestones.length > 0">
        <h4 class="milestones-title">Milestones ({{ job.milestones.length }})</h4>
        <div class="milestone-item" *ngFor="let milestone of job.milestones">
          <div class="milestone-info">
            <span class="milestone-title">{{ milestone.title }}</span>
            <span class="milestone-amount">{{ formatCurrency(milestone.amount) }}</span>
          </div>
          <span class="milestone-status" [ngClass]="'milestone-' + milestone.status">
            {{ milestone.status }}
          </span>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="job-actions">
        <button class="btn-secondary" *ngIf="currentUser?.role === 'company' && currentUser && job.client_id === currentUser.id">
          Manage
        </button>
        <button class="btn-primary" *ngIf="currentUser?.role === 'expert' && !job.expert_id && job.status === 'active'">
          Apply
        </button>
        <button class="btn-secondary" *ngIf="currentUser && job.expert_id === currentUser.id">
          View Details
        </button>
      </div>
    </article>
  </div>
</div>
